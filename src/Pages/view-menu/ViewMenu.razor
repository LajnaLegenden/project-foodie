@page "/order"
@using project_foodie.Data
@using project_foodie.Model
@using project_foodie.Pages.view_menu.components
@inject NavigationManager UriHelper
<div class="information">
    <h1 class="text-week">Vecka 7</h1>
    <h1 class="text-day">@activeWeekday @dateString</h1>
</div>
<div class="categories">
    <button @onclick="ToggleClass1" class="@ButtonClass1">Kött</button>
    <button @onclick="ToggleClass2" class="@ButtonClass2">Fläsk</button>
    <button @onclick="ToggleClass3" class="@ButtonClass3">Kyckling</button>
    <button @onclick="ToggleClass4" class="@ButtonClass4">Grönsaker</button>
</div>

@if (viewMenu) 
{
    <div class="menu-container">
        <MenuContainer activeDate="@activeDate"/>
        <div class="button-container">
            <button @onclick="DecrementDate" class="button-back">Föregående dag</button>
            <button @onclick="IncrementDate" class="button-forward">Nästa dag</button>
        </div>
    </div>
}
else {
    <div class="overview-container">
        <!-- Lägg in overview-container här-->
        <h1>Overview :)</h1>
    </div>
}

@code{
    // Testdatum
    DateTime startDate = new DateTime(2023, 2, 13);
    DateTime endDate = new DateTime(2023, 2, 17);
    DateTime activeDate = new DateTime(2023, 2, 13);

    List<DateTime> dates = new List<DateTime>();
    
    string activeWeekday;
    string dateString; 

    bool viewMenu = true;
    private int count = 1;
    protected override async Task OnInitializedAsync() 
    {
        activeWeekday = convertToWeekday(activeDate);
        dateString = dateFormat(activeDate);
    }

    private string convertToWeekday(DateTime date) 
    {
        string weekday = "";
        
        weekday = date.ToString("dddddd", new System.Globalization.CultureInfo("sv-SE"));
        weekday = char.ToUpper(weekday[0]) + weekday.Substring(1);

        return weekday;
    }

    private string dateFormat(DateTime date) 
    {
        string dateAsString = "";

        dateAsString = date.ToString("dd/M");

        return dateAsString;
    }

    void Navigate()
    {
        if(count == 1) {
            UriHelper.NavigateTo("order");
        }
    }

    private void IncrementDate()
    {
        if (activeDate <= endDate) 
        {
            activeDate = activeDate.AddDays(1);
            if (activeDate > endDate) 
            {
                viewMenu = false;
            }
            else {
                //count++;
                //Console.WriteLine(count);
                activeWeekday = convertToWeekday(activeDate);
                dateString = dateFormat(activeDate);
            }
        }  
    }

    private void DecrementDate()
    {
        if (activeDate > startDate) 
        {
            //count--;
            //Console.WriteLine(count);
            activeDate = activeDate.AddDays(-1);
        }

        activeWeekday = convertToWeekday(activeDate);
        dateString = dateFormat(activeDate);
    }
    
    private Boolean btn_clicked1 = false;
    private Boolean btn_clicked2 = false;
    private Boolean btn_clicked3 = false;
    private Boolean btn_clicked4 = false;
    private string ButtonClass1 => btn_clicked1 ? "button-category-clicked" : "button-category";
    private string ButtonClass2 => btn_clicked2 ? "button-category-clicked" : "button-category";
    private string ButtonClass3 => btn_clicked3 ? "button-category-clicked" : "button-category";
    private string ButtonClass4 => btn_clicked4 ? "button-category-clicked" : "button-category";

    private void ToggleClass1()
    {
        if(btn_clicked1 == true) {
            btn_clicked1 = false;
        } else {
            btn_clicked1 = true;
            btn_clicked2 = false;
            btn_clicked3 = false;
            btn_clicked4 = false;
        };
    }
    private void ToggleClass2()
    {
        if(btn_clicked2 == true) {
            btn_clicked2 = false;
        } else {
            btn_clicked2 = true;
            btn_clicked1 = false;
            btn_clicked3 = false;
            btn_clicked4 = false;
        };
    }
    private void ToggleClass3()
    {
        if(btn_clicked3 == true) {
            btn_clicked3 = false;
        } else {
            btn_clicked3 = true;
            btn_clicked1 = false;
            btn_clicked2 = false;
            btn_clicked4 = false;
        };
    }
    private void ToggleClass4()
    {
        if(btn_clicked4 == true) {
            btn_clicked4 = false;
        } else {
            btn_clicked4 = true;
            btn_clicked1 = false;
            btn_clicked2 = false;
            btn_clicked3 = false;
        };
    }
}